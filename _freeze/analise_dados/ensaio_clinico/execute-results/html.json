{
  "hash": "b1d446089a19b416f3eaf279eaccfafc",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"Análise de dados: Eficácia do captopril na redução da pressão arterial sistólica\"\nlang: pt\ntoc: true\ncode-annotations: \"hover\"\n---\n\nUm grupo de pesquisadores realizou um ensaio clínico randomizado, duplo-cego e controlado por placebo para avaliar a eficácia do captopril na redução da pressão arterial sistólica (PAS) em pacientes com hipertensão estágio 2.\n\nForam recrutados 200 pacientes, randomizados em dois grupos:\n\n- Grupo Intervenção (Captopril): 100 pacientes\n- Grupo Controle (Placebo): 100 pacientes\n\nOs pesquisadores coletaram os seguintes dados após 12 semanas de tratamento:\n\n- Redução da PAS (mmHg) – variável contínua\n- Idade (anos) – variável contínua\n- Índice de Massa Corporal (IMC, kg/m²) – variável contínua\n- Presença de Diabetes (Sim/Não) – variável categórica\n- Uso prévio de anti-hipertensivos (Sim/Não) – variável categórica\n- Eventos adversos (Sim/Não) – variável categórica\n\n\n## Objetivos\n\n- Explorar os dados sobre a eficácia do captopril na redução da pressão arterial sistólica (PAS) em pacientes com hipertensão estágio 2.\n\n- Verificar a eficácia do captopril na redução da pressão arterial sistólica (PAS) em pacientes com hipertensão estágio 2 \n- Verificar se a ocorrência de eventos adversos difere entre os grupos.\n\n<!-- - Investigar se há uma interação entre o efeito do captopril e a presença de diabetes na redução da PAS. -->\n\n\n\nFonte dos dados:\n\n- <https://raw.githubusercontent.com/tiagomartin/est104/refs/heads/master/dados/dados_ensaio_clinico_complexo.csv>\n\n\n\n## Preparação\n\n\n### Carregando os pacotes R\n\n\n::: {.cell}\n\n```{.r .cell-code}\npacman::p_load(\n  rio,          # importa arquivos\n  here,         # localiza arquivos\n  skimr,        # gera visualização dos dados\n  tidyverse,    # gestão dos dados + gráficos no ggplot2 \n  gtsummary,    # resumo estatísticos e testes\n  rstatix,      # resumo e testes estatísticos\n  janitor,      # adiciona números absolutos e porcentagens às tabelas\n  scales,       # facilmente converte proporções para porcentagens\n  flextable,    # converte tabelas para o formato de imagens\n  descriptr,    # construir tabela de distribuição de frequência em classes\n  car,          # aplicação do teste de Levene para homogeneidade de variâncias\n  BSDA          # aplicação do teste z para comparação de médias\n  ) \n```\n:::\n\n## Carregando os dados\n\n::: {.cell}\n\n```{.r .cell-code}\ndados_brutos = rio::import(\"https://raw.githubusercontent.com/tiagomartin/est104/refs/heads/master/dados/dados_ensaio_clinico_complexo.csv\")\ndados_brutos %>% str()\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n'data.frame':\t200 obs. of  8 variables:\n $ Paciente             : int  1 2 3 4 5 6 7 8 9 10 ...\n $ Grupo                : chr  \"Intervenção\" \"Intervenção\" \"Intervenção\" \"Intervenção\" ...\n $ Idade                : int  64 58 66 75 57 57 75 67 55 65 ...\n $ IMC                  : num  29.4 30.2 32.3 32.2 22.5 ...\n $ Diabetes             : int  0 0 0 1 1 1 1 0 0 1 ...\n $ Uso_Anti_hipertensivo: int  0 1 0 0 0 1 1 1 0 1 ...\n $ Redução_PAS_mmHg     : num  17.46 1.32 4.21 20.95 16.37 ...\n $ Eventos_Adversos     : int  0 0 0 0 0 0 0 1 1 1 ...\n```\n\n\n:::\n:::\n\n## Explorando os dados sobre a eficácia do captopril na redução da pressão arterial sistólica (PAS) \n\nOs principais resultados descritivos são:\n\n::: {.cell}\n\n```{.r .cell-code}\ndados_brutos %>% \n  group_by(Grupo) %>% \n  summarise(Media_Red_PAS = mean(Redução_PAS_mmHg, na.rm=TRUE), \n            DP_Red_PAS = sd(Redução_PAS_mmHg, na.rm=TRUE))\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 2 × 3\n  Grupo       Media_Red_PAS DP_Red_PAS\n  <chr>               <dbl>      <dbl>\n1 Controle             6.61       5.59\n2 Intervenção         15.3        7.43\n```\n\n\n:::\n:::\n\nPodemos observar que, em média, o uso de captopril reflete em uma maior redução da pressão arterial sistólica. Essa mesma informação pode ser visualizada analisando a distribuição da redução da PAS por meio de histogramas, indicando uma maior redução média no grupo intervenção.\n\n::: {.cell}\n\n```{.r .cell-code}\ndados_brutos %>% \n  ggplot(aes(x=Redução_PAS_mmHg, fill=Grupo)) + \n  geom_histogram(alpha=0.6, position=\"identity\", bins=30) + \n  labs(title=\"Distribuição da Redução da PAS\", x=\"Redução da PAS (mmHg)\", y=\"Frequência\")\n```\n\n::: {.cell-output-display}\n![](ensaio_clinico_files/figure-html/unnamed-chunk-4-1.png){width=672}\n:::\n:::\n\n\n## Verificando a eficácia do captopril na redução da pressão arterial sistólica (PAS) em pacientes com hipertensão\n\nComo a variável *Redução da PAS (mmHg)* é uma variável contínua, para verificar se, de fato, o uso do captopril reduz a pressão arterial sistólica (PAS) em pacientes com hipertensão, podemos realizar um teste t para amostras independentes para comparar as médias de redução da PAS entre os grupos.\n\nPara aplicação do teste t para amostras independentes, alguns pressupostos devem ser satisfeitos:\n\n    a) A variável resposta tem distribuição normal nos dois grupos\n    b) As variâncias dois dois grupos são iguais, ou seja, há homocedasticidade\n    \n\nVerifiquemos se a primeira suposição é satisfeita, usando a função **shapiro.test()** do R para aplicação do teste de normalidade de Shapiro-Wilk nas amostras de cada grupo (intervenção e placebo), adotando um nível de significância $\\alpha = 0,05$.\n\n$H_0:$ a variável de interesse é oriunda de uma população com distribuição normal;\n\n$H_a:$ a variável de interesse não é oriunda de uma população com distribuição normal.\n\n::: {.cell}\n\n```{.r .cell-code}\ndados_brutos %>% \n  dplyr::select(Grupo,Redução_PAS_mmHg) %>% \n  group_by(Grupo) %>%  \n  summarise_all(.funs = funs(statistic = shapiro.test(.)$statistic, \n                             p.value = shapiro.test(.)$p.value))\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 2 × 3\n  Grupo       statistic p.value\n  <chr>           <dbl>   <dbl>\n1 Controle        0.975  0.0518\n2 Intervenção     0.985  0.300 \n```\n\n\n:::\n:::\n\nNote que em ambos os grupos o p-valor do teste de normalidade foi maior que o nível de significância adotado, indicando a não rejeição da hipótese nula. Logo é aceitável dizer que a variável *Redução da PAS (mmHg)* tem distribuição normal nos dois grupos.\n\nA segunda suposição pode ser testada utilizando o teste de Levene. É realizado com a função **leveneTest()** do pacote *car* do R.\n\n$H_0: \\sigma_I^2 = \\sigma_P^2$ (as variâncias são iguais) \n\n$H_a:\\sigma_I^2 \\neq \\sigma_P^2$ (as variâncias não são iguais)\n\n\nem que $\\sigma_I^2$ representa a variância do grupo intervenção e $\\sigma_P^2$ a variância do grupo placebo.\n\n::: {.cell}\n\n```{.r .cell-code}\nleveneTest(Redução_PAS_mmHg ~ as.factor(Grupo), data = dados_brutos)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nLevene's Test for Homogeneity of Variance (center = median)\n       Df F value  Pr(>F)  \ngroup   1  6.0561 0.01471 *\n      198                  \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n```\n\n\n:::\n:::\n\nPodemos observar que o teste somente foi significativo a um nível de significância $\\alpha = 0,01$, o que inviabilizaria a aplicação do teste t ao nível de $5\\%$ de significância.  Porém, no caso de amostras grandes ($n_1$ e $n_2 \\geq 30$), dispomos de um teste em que não é necessária qualquer suposição adicional sobre $\\sigma_I^2$ e $\\sigma_P^2$, ou seja, as variâncias podem ser iguais ou diferentes. Trata-se do teste z para comparação de médias ($Z_{médias}$).\n\n\n\nSejam então, as seguintes hipóteses:\n\n$$H_0: \\mu_I - \\mu_P = 0$$\n$$H_a: \\mu_I - \\mu_P > 0$$\nem que $\\mu_I$ representa a média do grupo intervenção e $\\mu_P$ a média do grupo placebo. A estatística do teste para testar a hipótese de igualdade de médias é dada por\n\n$$Z_{médias} = \\dfrac{(\\bar{x}_I - \\bar{x}_P) - (\\mu_I - \\mu_P)}{\\sqrt{\\dfrac{s_I^2}{n_I} + \\dfrac{s_P^2}{n_P}}}$$\nSob $H_0$, temos que \n\n$$Z_{médias} \\sim N(0,1)$$\nNo R executamos o teste z para comparação de médias da seguinte forma:\n\n::: {.cell}\n\n```{.r .cell-code}\ncaptopril = dados_brutos %>% \n  dplyr::filter(Grupo=='Intervenção') %>% \n  dplyr::select(Redução_PAS_mmHg) %>% \n  unlist()\n\nplacebo = dados_brutos %>% \n  dplyr::filter(Grupo=='Controle') %>% \n  dplyr::select(Redução_PAS_mmHg) %>% unlist()\n\nBSDA::z.test(x = captopril,y = placebo,\n              alternative = \"greater\",\n              sigma.x = sd(captopril),\n              sigma.y = sd(placebo),\n              conf.level = 0.95)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n\tTwo-sample z-Test\n\ndata:  captopril and placebo\nz = 9.3053, p-value < 2.2e-16\nalternative hypothesis: true difference in means is greater than 0\n95 percent confidence interval:\n 7.123878       NA\nsample estimates:\nmean of x mean of y \n15.259091  6.605576 \n```\n\n\n:::\n:::\n\nA estatística do teste z para comparação de médias calculada foi $Z_{médias} = 9,3053$ e o p-valor correspondente foi aproximadamente igual a zero ($p-value < 2.2e-16$). Como esse valor p é menor que $0,05 = \\alpha$, temos evidências suficientes para rejeitar a hipótese nula. Assim, concluímos que a redução média da pressão arterial sistólica (PAS) em pacientes com hipertensão é significativamente maior entre os pacientes que tomaram o captopril do que entre os que não tomaram, a um nível de significância igual a 5%. Logo, podemos afirmar que o captopril é eficaz na redução da pressão arterial sistólica (PAS).\n\n## Verificando se a ocorrência de eventos adversos difere entre os grupos.\n\nComo a variável *Eventos_Adversos* é uma variável categórica com dois níveis (Sim = 1/Não = 0), podemos montar uma tabela de contingência para verificar  se a ocorrência de eventos adversos difere entre os grupos.\n\n::: {.cell}\n\n```{.r .cell-code}\ntabela = dados_brutos %>% \n  tabyl(Grupo, Eventos_Adversos)%>% \n  adorn_totals(where = 'both')\n\ntabela\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n       Grupo   0  1 Total\n    Controle  93  7   100\n Intervenção  86 14   100\n       Total 179 21   200\n```\n\n\n:::\n:::\n\nUsamos o teste qui-quadrado para verificar se existe associação entre os eventos adversos e o grupo na qual o paciente pertence:\n\n$H_0:$ A proporção de pacientes que tiveram eventos adversos ao tomar captopril é igual à proporção de pacientes que tiveram eventos adversos ao tomar placebo\n\n::: {.cell}\n\n```{.r .cell-code}\nchisq.test(tabela, correct = FALSE)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n\tPearson's Chi-squared test\n\ndata:  tabela\nX-squared = 2.6071, df = 1, p-value = 0.1064\n```\n\n\n:::\n:::\n\nO valor crítico ao nível de significância de 5% da distribuição [qui-quadrado](/documentos/Tabela%20da%20Qui-quadrado.pdf) com 1 grau de liberdade é 3,841. Como $\\chi^2 = 2,6071 < 3,841 = \\chi^2_1(0,05)$, com esse tamanho de amostra não foi detectada diferença significativa entre os grupos (Intervenção e Controle).\n\nNote que podemos chegar à mesma conclusão, de que não foi detectada diferença significativa entre os grupos (Intervenção e Controle) olhando apenas para o p-valor. Neste caso temos\n\n$$\\text{p-valor} = P(\\chi_1^2 \\geq 2,6071) = 0,1064 > 0,05 = \\alpha.$$\nLogo, não rejeitamos a hipótese $H_0$. Assim, a ocorrência de eventos adversos não difere entre os grupos.\n\n\n",
    "supporting": [
      "ensaio_clinico_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}